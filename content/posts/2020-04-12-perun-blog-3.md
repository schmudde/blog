---
title: How to use Perun to Create a Static Blog &bull; Part 3
description: Time &amp; Tags
author: David Schmudde
author-email: d@schmud.de
author-url: http://schmud.de
author-github: schmudde
author-twitter: dschmudde
author-avatar: /images/anton-avatar.png
location: Turin, Italy
date-created: 2013-12-27
date-modified: 2013-12-30
date-published:
headline:
in-language: en
keywords: clojure, blogging
canonical-url: http://schmud.de
uuid:
tags:
 - clojure
 - tools
---


## Time

As part of the header for `render-post`:

```
[:header.tc
    [:h1 (:title post)]
    [:time (:date-published post)]]
```

The `:date-published` keyword contains a `class java.util.Date` value. Create a function to format the date:

```
(defn format-date [date]
  (if date (.format (java.text.SimpleDateFormat. "MMMM dd, yyyy") date)))
```

If a post has not been published, it does not have a `:date-published` value. Thus the first `if date` test.

An aside about naming, Zach Telleman.

Add the conversion function to the header and it's finished:

```
[:header.tc
    [:h1 (:title post)]
    [:time (format-date (:date-published post))]]
```

TODO: add a `published?` tag to the filterer

## Tags

### Working with Published Posts

Back to `build.boot`. Like the render task, the tag task should operate on published posts. To filter out webpages, collections, and unpublished posts, first breakout the original filter into its own predicate.

```
(defn post? [{:keys [original-path] :as meta}]
  (some-> original-path (.startsWith "posts/")))
```

Then create another predicate to see if `:date-published` exists in the metadata is set to anything other than `nil` or `false`.

```
(defn published? [{:keys [date-published] :as meta}]
  (if date-published true false))
```

Adding the predicates to `build` makes the process more complete.

1. The `collection` only adds files that are **published** to the `index.html`.
2. Only `render` a file if it is a **post** and it is **published**.

```
(perun/collection :renderer 'site.index/render-index-page
                  :page "index.html"
                  :filterer published?)
(perun/render :renderer 'site.index/render-post-pages :filterer (and post? published?))
```

### Tags

Add the `tags` task to the `build.boot`. Direct the resulting `.html` pages to a `/tags` subdirectory to keep things tidy.

```
(perun/tags :renderer 'site.index/render-tag-pages
            :filterer post?
            :out-dir "public/tags")
```

Each tag will generate its own `.html` page. So if 3 tags exist for 20 posts, the resulting list will look something like `("foo" "bar" "baz")`. `foo.html` will list the title of every post that has been tagged with `foo`.

Two new functions are introduced:

1. `render-tag-pages` renders the new pages.
2. `tags->links` is called everytime a post is rendered. It turns the list of tags into a list of hyperlinks that point to the approprite page.

```
(defn tags->links [tags]
  [:span {:class "tags"}
   (map (fn [tag] [:a.link.mr2 {:href (str "/tags/" tag ".html")} tag]) tags)])

(defn render-tag-pages [{global-meta :meta post :entry posts :entries}]
  (page/html5 {:lang "en" :itemtype "http://schema.org/Blog"}
              (head global-meta post)
              [:body
               (header global-meta)
               [:h1.tc (str "Posts Tagged As \"" (:tag post) "\"" )]
               (list-posts posts)]))
```

Now the tags are added to the header of each post as part of `render-post`:

```
[:header.tc
    [:h1 (:title post)]
    [:div [:time (format-date (:date-published post))]
     [:span (str ", tags: ")] (tags->links (:tags post))]]
```

## RSS
